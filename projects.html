<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projects - OncoHarmony Network</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/data-loader.js"></script>
</head>
<body>
    <nav class="nav-bar" id="navbar">
        <div class="container nav-content">
            <a href="index.html" class="nav-brand">
                <img src="images/logo-nav.png" alt="OncoHarmony Logo" class="nav-brand-logo">
                <span class="nav-brand-text">OncoHarmony</span>
            </a>
            
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="about.html" class="nav-link">About</a>
                <a href="members.html" class="nav-link">Members</a>
                <a href="publications.html" class="nav-link">Publications</a>
                <a href="projects.html" class="nav-link active">Projects</a>
                <a href="news.html" class="nav-link">News</a>
                <a href="contact.html" class="nav-link">Contact</a>
            </div>
            
            <button class="mobile-menu-btn" id="mobile-menu-button">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>
        
        <div class="mobile-nav" id="mobile-menu">
            <div class="container">
                <a href="index.html" class="mobile-nav-link">Home</a>
                <a href="about.html" class="mobile-nav-link">About</a>
                <a href="members.html" class="mobile-nav-link">Members</a>
                <a href="publications.html" class="mobile-nav-link">Publications</a>
                <a href="projects.html" class="mobile-nav-link active">Projects</a>
                <a href="news.html" class="mobile-nav-link">News</a>
                <a href="contact.html" class="mobile-nav-link">Contact</a>
            </div>
        </div>
    </nav>

    <header class="page-header">
        <div class="container page-header-content">
            <h1 class="page-title">Our Projects</h1>
            <p class="page-subtitle">
                Exploring the frontier of Immuno-oncology through innovative research initiatives
            </p>
        </div>
    </header>

    <section class="section section-white">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Featured Projects</h2>
                <p class="section-subtitle">Our flagship research initiatives driving breakthroughs</p>
            </div>
            
            <div id="featured-projects" class="grid-2">
                <div class="project-card">
                    <div class="project-card-header">
                        <div class="project-icon">
                            <i class="fas fa-code-branch"></i>
                        </div>
                        <h3 class="project-title">Loading...</h3>
                        <p class="project-type">Loading...</p>
                    </div>
                    <div class="project-card-body">
                        <p class="project-description">Loading project description...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section section-light" style="padding-top: 0; padding-bottom: 1.5rem;">
        <div class="container">
            <div id="category-buttons" class="category-filter"></div>
        </div>
    </section>

    <section id="project-details" class="section section-white" style="display: none;">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 class="section-title" id="project-details-title" style="text-align: left; margin: 0;">Project Details</h2>
                <a href="projects.html" class="project-link">
                    <i class="fas fa-arrow-left"></i> Back to Projects
                </a>
            </div>
            
            <div id="project-details-content">
                <div style="text-align: center; padding: 3rem 0;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-600); margin-bottom: 1rem;"></i>
                    <p style="color: var(--neutral-600);">Loading project details...</p>
                </div>
            </div>
        </div>
    </section>

    <section id="all-projects-section" class="section section-light">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">All Projects</h2>
                <p class="section-subtitle">Browse our complete research portfolio</p>
            </div>
            
            <div id="all-projects" class="grid-3">
                <div class="project-card">
                    <div class="project-card-header">
                        <div class="project-icon">
                            <i class="fas fa-microscope"></i>
                        </div>
                        <h3 class="project-title">Loading...</h3>
                        <p class="project-type">Loading...</p>
                    </div>
                    <div class="project-card-body">
                        <p class="project-description">Loading project description...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="footer-container"></div>

    <script>
        fetch('components/footer.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('footer-container').innerHTML = html;
            })
            .catch(error => console.error('Error loading footer:', error));
    </script>

    <script>
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('active');
        });
        
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 10) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
        
        let currentFilter = 'All Projects';
        
        async function loadProjects() {
            await dataLoader.load();
            const projectsData = dataLoader.getProjects();
            
            const urlParams = new URLSearchParams(window.location.search);
            const projectId = urlParams.get('id');
            
            if (projectId) {
                await loadProjectDetails(projectId);
            } else {
                generateCategoryButtons(projectsData.all_projects);
                
                const featuredProjectsContainer = document.getElementById('featured-projects');
                featuredProjectsContainer.innerHTML = projectsData.featured_projects.map(project => {
                    const id = project.id || project.name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
                    return `
                        <div class="project-card fade-in">
                            <div class="project-card-header">
                                <div class="project-icon">
                                    <i class="fas fa-${project.icon}"></i>
                                </div>
                                <h3 class="project-title">${project.name}</h3>
                                <p class="project-type">${project.type}</p>
                            </div>
                            <div class="project-card-body">
                                <p class="project-description">${project.description}</p>
                                <div class="project-tags">
                                    ${project.technologies.map(tech => `<span class="project-tag">${tech}</span>`).join('')}
                                </div>
                                <div style="display: flex; gap: 1.5rem; flex-wrap: wrap;">
                                    ${project.links.website ? `<a href="${project.links.website}" class="project-link"><i class="fas fa-globe"></i> Website</a>` : ''}
                                    ${project.links.download ? `<a href="${project.links.download}" class="project-link"><i class="fas fa-download"></i> Download</a>` : ''}
                                    <a href="projects.html?id=${id}" class="project-link"><i class="fas fa-info-circle"></i> Details</a>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                renderAllProjects(projectsData.all_projects);
            }
        }
        
        function generateCategoryButtons(projects) {
            const categories = new Set();
            categories.add('All Projects');
            
            projects.forEach(project => {
                if (project.tags) {
                    project.tags.forEach(tag => {
                        categories.add(tag);
                    });
                }
            });
            
            const categoryButtonsContainer = document.getElementById('category-buttons');
            categoryButtonsContainer.innerHTML = Array.from(categories).map(category => {
                const isActive = category === currentFilter;
                return `
                    <button class="filter-btn ${isActive ? 'active' : ''}" data-category="${category}" onclick="filterProjects('${category}')">
                        ${category}
                    </button>
                `;
            }).join('');
        }
        
        function filterProjects(category) {
            currentFilter = category;
            
            const buttons = document.querySelectorAll('#category-buttons button');
            buttons.forEach(button => {
                if (button.dataset.category === category) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
            
            dataLoader.load().then(() => {
                const projectsData = dataLoader.getProjects();
                let filteredProjects = projectsData.all_projects;
                
                if (category !== 'All Projects') {
                    filteredProjects = projectsData.all_projects.filter(project => {
                        return project.tags && project.tags.includes(category);
                    });
                }
                
                renderAllProjects(filteredProjects);
            });
        }
        
        function renderAllProjects(projects) {
            const allProjectsContainer = document.getElementById('all-projects');
            
            if (projects.length === 0) {
                allProjectsContainer.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 3rem 0;">
                        <i class="fas fa-folder-open" style="font-size: 3rem; color: var(--neutral-300); margin-bottom: 1rem;"></i>
                        <p style="color: var(--neutral-500);">No projects found in this category.</p>
                    </div>
                `;
                return;
            }
            
            allProjectsContainer.innerHTML = projects.map(project => {
                const id = project.id || project.name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
                return `
                    <div class="project-card fade-in">
                        <div class="project-card-header">
                            <div class="project-icon">
                                <i class="fas fa-${project.icon}"></i>
                            </div>
                            <h3 class="project-title">${project.name}</h3>
                            <p class="project-type">${project.type || project.category || 'Research Project'}</p>
                        </div>
                        <div class="project-card-body">
                            <p class="project-description">${project.description}</p>
                            <div class="project-tags">
                                ${(project.tags || []).map(tag => `<span class="project-tag">${tag}</span>`).join('')}
                            </div>
                            <a href="projects.html?id=${id}" class="project-link">
                                Learn More <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        async function loadProjectDetails(projectId) {
            document.getElementById('project-details').style.display = 'block';
            document.getElementById('featured-projects').parentElement.style.display = 'none';
            document.getElementById('category-buttons').parentElement.parentElement.style.display = 'none';
            document.getElementById('all-projects-section').style.display = 'none';
            
            const contentContainer = document.getElementById('project-details-content');
            const titleElement = document.getElementById('project-details-title');
            titleElement.textContent = 'Loading...';
            contentContainer.innerHTML = `
                <div style="text-align: center; padding: 3rem 0;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-600); margin-bottom: 1rem;"></i>
                    <p style="color: var(--neutral-600);">Loading project details...</p>
                </div>
            `;
            
            const projectDetails = await dataLoader.loadProjectDetails(projectId);
            
            if (projectDetails) {
                titleElement.textContent = projectDetails.name || 'Project Details';
                
                let html = `
                    <div class="card">
                        <div class="card-body" style="padding: 2.5rem;">
                            <div style="display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2rem;">
                                <div style="width: 72px; height: 72px; border-radius: var(--radius-xl); background: linear-gradient(135deg, var(--primary-100), var(--primary-200)); display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-${projectDetails.icon || 'project-diagram'}" style="font-size: 2rem; color: var(--primary-600);"></i>
                                </div>
                                <div>
                                    <h3 style="font-size: 1.75rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 0.25rem;">${projectDetails.name || 'Project Details'}</h3>
                                    <p style="color: var(--primary-600); font-weight: 600; margin: 0;">${projectDetails.type || projectDetails.category || 'Research Project'}</p>
                                </div>
                            </div>
                `;
                
                if (projectDetails.overview) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-eye" style="color: var(--primary-600);"></i> Overview
                            </h4>
                            <p style="color: var(--neutral-600); line-height: 1.8; margin: 0;">${projectDetails.overview}</p>
                        </div>
                    `;
                }
                
                if (projectDetails.background) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-book" style="color: var(--primary-600);"></i> Background
                            </h4>
                            <p style="color: var(--neutral-600); line-height: 1.8; margin: 0;">${projectDetails.background}</p>
                        </div>
                    `;
                }
                
                if (projectDetails.objectives && (Array.isArray(projectDetails.objectives) || typeof projectDetails.objectives === 'string')) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-bullseye" style="color: var(--primary-600);"></i> Objectives
                            </h4>
                            <ul style="list-style: none; padding: 0; margin: 0;">
                                ${Array.isArray(projectDetails.objectives) ? projectDetails.objectives.map(obj => `
                                    <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                        <i class="fas fa-check-circle" style="color: var(--success-500); margin-top: 0.25rem;"></i>
                                        <span style="color: var(--neutral-600);">${obj}</span>
                                    </li>
                                `).join('') : `
                                    <li style="display: flex; align-items: flex-start; gap: 0.75rem;">
                                        <i class="fas fa-check-circle" style="color: var(--success-500); margin-top: 0.25rem;"></i>
                                        <span style="color: var(--neutral-600);">${projectDetails.objectives}</span>
                                    </li>
                                `}
                            </ul>
                        </div>
                    `;
                }
                
                if (projectDetails.content) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-flask" style="color: var(--primary-600);"></i> Research Content
                            </h4>
                            <p style="color: var(--neutral-600); line-height: 1.8; margin: 0;">${projectDetails.content}</p>
                        </div>
                    `;
                }

                if (projectDetails.research_areas && projectDetails.research_areas.length > 0) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-flask" style="color: var(--primary-600);"></i> Research Areas
                            </h4>
                            <div class="grid-2">
                                ${projectDetails.research_areas.map(area => `
                                    <div class="card" style="padding: 1.25rem;">
                                        <h5 style="font-weight: 600; color: var(--neutral-900); margin: 0 0 0.5rem;">${area.name}</h5>
                                        <p style="color: var(--neutral-600); font-size: 0.875rem; margin: 0 0 0.5rem;">${area.description}</p>
                                        <span style="display: inline-block; background: var(--primary-100); color: var(--primary-700); padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500;">${area.status}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                if (projectDetails.methodology && (Array.isArray(projectDetails.methodology) || typeof projectDetails.methodology === 'string')) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-cogs" style="color: var(--primary-600);"></i> Methodology
                            </h4>
                            <ul style="list-style: none; padding: 0; margin: 0;">
                                ${Array.isArray(projectDetails.methodology) ? projectDetails.methodology.map(method => `
                                    <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                        <i class="fas fa-arrow-right" style="color: var(--primary-500); margin-top: 0.25rem;"></i>
                                        <span style="color: var(--neutral-600);">${method}</span>
                                    </li>
                                `).join('') : `
                                    <li style="display: flex; align-items: flex-start; gap: 0.75rem;">
                                        <i class="fas fa-arrow-right" style="color: var(--primary-500); margin-top: 0.25rem;"></i>
                                        <span style="color: var(--neutral-600);">${projectDetails.methodology}</span>
                                    </li>
                                `}
                            </ul>
                        </div>
                    `;
                }
                
                if (projectDetails.outcomes && (Array.isArray(projectDetails.outcomes) || typeof projectDetails.outcomes === 'string')) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-trophy" style="color: var(--primary-600);"></i> Expected Outcomes
                            </h4>
                            <ul style="list-style: none; padding: 0; margin: 0;">
                                ${Array.isArray(projectDetails.outcomes) ? projectDetails.outcomes.map(outcome => `
                                    <li style="display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.75rem;">
                                        <i class="fas fa-star" style="color: var(--accent-500); margin-top: 0.25rem;"></i>
                                        <span style="color: var(--neutral-600);">${outcome}</span>
                                    </li>
                                `).join('') : `
                                    <li style="display: flex; align-items: flex-start; gap: 0.75rem;">
                                        <i class="fas fa-star" style="color: var(--accent-500); margin-top: 0.25rem;"></i>
                                        <span style="color: var(--neutral-600);">${projectDetails.outcomes}</span>
                                    </li>
                                `}
                            </ul>
                        </div>
                    `;
                }
                
                if (projectDetails.team && projectDetails.team.length > 0) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-users" style="color: var(--primary-600);"></i> Team
                            </h4>
                            <div class="grid-2">
                                ${projectDetails.team.map(member => `
                                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--neutral-50); border-radius: var(--radius-lg);">
                                        <div style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-100), var(--primary-200)); display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-user" style="color: var(--primary-600);"></i>
                                        </div>
                                        <div>
                                            <p style="font-weight: 600; color: var(--neutral-900); margin: 0;">${member.name}</p>
                                            <p style="color: var(--primary-600); font-size: 0.875rem; margin: 0;">${member.role}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                if (projectDetails.publications && projectDetails.publications.length > 0) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-file-alt" style="color: var(--primary-600);"></i> Publications
                            </h4>
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                ${projectDetails.publications.map(pub => `
                                    <div style="padding: 1rem; background: var(--primary-50); border-radius: var(--radius-lg); border-left: 4px solid var(--primary-500);">
                                        <h5 style="font-weight: 600; color: var(--neutral-900); margin: 0 0 0.25rem;">${pub.title}</h5>
                                        <p style="color: var(--neutral-500); font-size: 0.875rem; margin: 0 0 0.5rem;">${pub.journal}, ${pub.year}</p>
                                        ${pub.doi ? `<a href="https://doi.org/${pub.doi}" style="color: var(--primary-600); font-size: 0.875rem; text-decoration: none;">DOI: ${pub.doi}</a>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                if (projectDetails.contact) {
                    html += `
                        <div>
                            <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-envelope" style="color: var(--primary-600);"></i> Contact
                            </h4>
                            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                ${projectDetails.contact.email ? `<p style="display: flex; align-items: center; gap: 0.75rem; color: var(--neutral-600); margin: 0;"><i class="fas fa-envelope" style="color: var(--primary-600);"></i> ${projectDetails.contact.email}</p>` : ''}
                                ${projectDetails.contact.phone ? `<p style="display: flex; align-items: center; gap: 0.75rem; color: var(--neutral-600); margin: 0;"><i class="fas fa-phone" style="color: var(--primary-600);"></i> ${projectDetails.contact.phone}</p>` : ''}
                                ${projectDetails.contact.address ? `<p style="display: flex; align-items: flex-start; gap: 0.75rem; color: var(--neutral-600); margin: 0;"><i class="fas fa-map-marker-alt" style="color: var(--primary-600); margin-top: 0.25rem;"></i> ${projectDetails.contact.address}</p>` : ''}
                            </div>
                        </div>
                    `;
                }
                
                html += `
                        </div>
                    </div>
                `;
                
                contentContainer.innerHTML = html;
            } else {
                titleElement.textContent = 'Project Not Found';
                contentContainer.innerHTML = `
                    <div style="text-align: center; padding: 3rem 0;">
                        <i class="fas fa-exclamation-circle" style="font-size: 3rem; color: var(--error-500); margin-bottom: 1rem;"></i>
                        <h4 style="font-size: 1.25rem; font-weight: 700; color: var(--neutral-900); margin: 0 0 0.5rem;">Project Not Found</h4>
                        <p style="color: var(--neutral-500); margin: 0 0 1.5rem;">The project you are looking for does not exist.</p>
                        <a href="projects.html" class="btn btn-primary">Back to Projects</a>
                    </div>
                `;
            }
        }
        
        loadProjects().then(() => {
            if (typeof updateFooterFromDataLoader === 'function') {
                updateFooterFromDataLoader();
            }
        });
    </script>
</body>
</html>
